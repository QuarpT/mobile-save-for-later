AWSTemplateFormatVersion: '2010-09-09'
Description: Cloudforms resources for migration save for later to mobile
Parameters:
    MobileAccountId:
      Description: Account ID of the gu moble account which
      Type: String
Resources:
  SflDataMigrationS3Role:
    Type: AWS::IAM::Role
    Properties:
      RoleName: sfl-data-migration-s3-role
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          Action: sts:AssumeRole
          Effect: Allow
          Principal:
            Service:
              - ec2.amazonaws.com
            AWS: !Sub arn:aws:iam::${MobileAccountId}:root

  S3AccessPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: sfl-data-migration-s3-read-policy
      Path: /
      Roles: [!Ref SflDataMigrationS3Role]
      PolicyDocument:
        Version: 2012-10-17
        Statement:
          Sid: ReadConfigurationFromS3
          Effect: Allow
          Action:
            - s3:GetObject
          Resource:
            - !Sub arn:aws:s3:::gu-sfl-migration/*



